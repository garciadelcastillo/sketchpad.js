/*! Sketchpad.js v0.0.3 | (c) 2015 Jose Luis Garcia del Castillo */
Sketchpad=function(t){function e(){return n++}if(this.version="v0.0.3a1",this.build=1103,!window.jQuery||!$)return console.error("Sketchpad.js depends on jQuery.Please add it to current window context."),void 0;Math.PI,2*Math.PI,180/Math.PI,Math.PI/180;var i=this;this.elements=[],this.initialized=!1,this.canvas,this.canvasId,this.gr,this.parentDiv,this._canvasWidth,this._canvasHeight,this.width,this.height,this.frameCount=0,this.drawVisible=!0;var n=1;this.update=function(){},this.render=function(){i.gr.globalAlpha=1,i.gr.fillStyle="#ffffff",i.gr.clearRect(0,0,i._canvasWidth,i._canvasHeight),i.gr.fillRect(0,0,i._canvasWidth,i._canvasHeight),i.gr.translate(.5,.5);for(var t=0;i.elements.length>t;t++)i.elements[t]._.visible&&i.elements[t]._render(i.gr);i.gr.translate(-.5,-.5)},this.loop=function(){window.requestAnimFrame(i.loop),i.render(),i.update(),i.frameCount++},this.addElement=function(t){i.elements.push(t)},this.findElementNames=function(){this.elements.forEach(function(t){t._.name||t._findName()})},this.tagElementNames=function(){this.elements.forEach(function(t){t._.name||t._findName()},this)};var r=function(){this._={},this._.name=void 0,this._.id=e(),this._.parents=[],this._.children=[],this._.constrained=!0,this._.properties={},this._.p=this._.properties,i.addElement(this)};r.prototype._update=function(){},r.prototype._addParentParams=function(t){for(var e in t){var i=t[e];this._.parents.push(i),this._.properties[e]=i,i._&&i._.children&&i._.children.push(this)}},r.prototype._updateChildren=function(){for(var t=0;this._.children.length>t;t++)this._.children[t]._update(),this._.children[t]._updateChildren()},r.prototype._findName=function(){for(var t in window)if(window[t]==this)return this._.name=t,t;return!1},r.prototype.isConstrained=function(){return this._.constrained};var s=function(t){r.call(this),this._.value=t};s.prototype=Object.create(r.prototype),s.prototype.constructor=s,s.prototype.value=function(){var t=arguments,e=t.length;return 0==e?this._.value:1==e?this.isConstrained()?(console.warn("Sketchpad: this Variable is constrained"),!1):(this._.value=t[0],this._updateChildren(),!0):(console.error("Sketchpad: invalid arguments for Variable.value()"),!1)};var o=function(t){s.call(this,t),this._.type="wrap"};o.prototype=Object.create(s.prototype),o.prototype.constructor=o;var a=function(t){s.call(this,t),this._.type="numeral"};a.prototype=Object.create(s.prototype),a.prototype.constructor=a,a.prototype.add=function(t){return m.isNumber(t)?this.isConstrained()?(console.warn("constrain error"),this._.value):(this._.value+=t,this._updateChildren(),this._.value):(console.error("arg error"),void 0)},a.prototype.half=function(){return 0!=arguments.length?(console.error("error"),void 0):(this._.p.half||(this._.p.half=a.G.half(this)),this._.p.half)},this.numeral=function(t){return _(t).primitive("number")?a.G.fromNumber(t):(console.log("error..."),void 0)},this.numeral.half=function(t){return t.half()},this.numeral.linked=function(t,e){return a.G.linked(t,e)},a.G={fromNumber:function(t){var e=new a(t);return e._addParentParams({value:new o(t)}),e._update=a.U.fromNumber,e},half:function(t){var e=new a(t._.value/2);return e._addParentParams({operand:t}),e._update=a.U.half,e},linked:function(t,e){var i=new a(t._[e]);return i._addParentParams({element:t,property:e}),i._update=a.U.linked,i}},a.U={fromNumber:function(){this._.value=this._p.value._.value},half:function(){this._.value=this._.p.operand._.value/2},linked:function(){this._.value=this._.p.element._[this._.p.property]}};var u=function(){r.call(this),this._.visible=!0};u.prototype=Object.create(r.prototype),u.prototype.constructor=u,u.prototype.visible=function(t){this._.visible=t;var e=arguments,i=e.length;return 1==i&&(m.isBoolean(t)?(this._.value=t,this._updateChildren()):console.error("error")),this._.value};var h=function(t,e,i){u.call(this),this._.type="point",this._.x=t,this._.y=e,this._.radius=i||1};h.prototype=Object.create(u.prototype),h.prototype.constructor=h,h.prototype.set=function(t,e){l.objects(arguments).ofTypes("number","number")&&(this._.p.x&&this._.p.x.value(t),this._.p.y&&this._.p.y.value(e))},h.prototype.move=function(t,e){l.objects(arguments).ofTypes("number","number")&&(this._.p.x&&this._.p.x.add(t),this._.p.y&&this._.p.y.add(e))},this.point=function(){var t=arguments,e=t.length;switch(e){case 2:if(l.objects(t).ofTypes("numeric","numeric"))return h.G.fromNumericNumeric(t[0],t[1])}return console.error("Sketchpad: invalid arguments for Sketchpad.point"),void 0},this.point.along=function(){var t=arguments,e=t.length;switch(e){case 2:if(l.objects(t).ofTypes("line","numeric"))return h.G.onLine(t[0],t[1])}return console.error("Sketchpad: invalid arguments for Sketchpad.point.along"),void 0},h.G={fromNumericNumeric:function(t,e){var i=d(t),n=d(e),r=new h(i._.value,n._.value);return r._addParentParams({x:i,y:n}),r._update=h.U.fromNumericNumeric,r},onLine:function(t,e){var i=new h(0,0);return i._addParentParams({line:t,parameter:d(e)}),i._update=h.U.onLine,i._update(),i.parameter=h.U.parameter,i}},h.U={fromNumericNumeric:function(){this._.x=this._.p.x._.value,this._.y=this._.p.y._.value},onLine:function(){this._.x=this._.p.line._.x0+this._.p.parameter._.value*(this._.p.line._.x1-this._.p.line._.x0),this._.y=this._.p.line._.y0+this._.p.parameter._.value*(this._.p.line._.y1-this._.p.line._.y0)},parameter:function(t){return t&&m.isNumber(t)&&this._.p.parameter.value(t),this._.p.parameter}},h.prototype.x=function(){var t=arguments,e=t.length;return 0==e?(this._.p.x||(this._.p.x=i.number.linked(this,"x")),this._.p.x):(1==e&&this._.p.x.value(t[0]),void 0)},h.prototype.y=function(){var t=arguments,e=t.length;return 0==e?(this._.p.y||(this._.p.y=i.number.linked(this,"y")),this._.p.y):(1==e&&this._.p.y.value(t[0]),void 0)},h.prototype.radius=function(){var t=arguments,e=t.length;return 0==e?(this._.p.radius||(this._.p.radius=i.number.linked(this,"radius")),this._.p.radius):(1==e&&this._.p.radius.value(t[0]),void 0)},h.prototype._render=function(){i.gr.strokeStyle="black",i.gr.lineWidth=1,i.gr.fillStyle="white",i.gr.beginPath(),i.gr.arc(this._.x,this._.y,this._.radius,0,2*Math.PI),i.gr.stroke(),i.gr.fill()};var c=function(t,e,i){h.call(this,t,e,i),this._.subtype="node"};c.prototype=Object.create(h.prototype),c.prototype.constructor=c,this.node=function(){var t=arguments,e=t.length;switch(e){case 2:if(l.objects(t).ofTypes("numeric","numeric"))return c.G.fromNumericNumeric(t[0],t[1])}return console.error("Sketchpad: invalid arguments for Sketchpad.node"),void 0},c.G={fromNumericNumeric:function(t,e){var i=d(t),n=d(e),r=d(4),s=new c(i._.value,n._.value,r._.value);return s._addParentParams({x:i,y:n,radius:r}),s._update=c.U.fromNumericNumeric,s}},c.U={fromNumericNumeric:function(){this._.x=this._.p.x._.value,this._.y=this._.p.y._.value}};var p=function(t,e,i,n){u.call(this),this._.type="line",this._.x0=t,this._.y0=e,this._.x1=i,this._.y1=n};p.prototype=Object.create(u.prototype),p.prototype.constructor=p,p.prototype._render=function(){i.gr.strokeStyle="black",i.gr.strokeWidth=1,i.gr.beginPath(),i.gr.moveTo(this._.x0,this._.y0),i.gr.lineTo(this._.x1,this._.y1),i.gr.stroke()},p.prototype.start=function(){return 0!=arguments.length?(console.error("Sketchpad: invalid arguments for Line.start"),void 0):(this._.p.start||(this._.p.start=i.point(i.number.linked(this,"x0"),i.number.linked(this,"y0"))),this._.p.start)},p.prototype.end=function(){return 0!=arguments.length?(console.error("Sketchpad: invalid arguments for Line.end"),void 0):(this._.p.end||(this._.p.end=i.point(i.number.linked(this,"x1"),i.number.linked(this,"y1"))),this._.p.end)},p.prototype.pointAt=function(t){return i.point.along(this,t)},this.line=function(){var t=arguments,e=t.length;switch(e){case 2:if(l.objects(t).ofTypes("point","point"))return p.G.fromPointPoint(t[0],t[1]);break;case 4:if(l.objects(t).ofTypes("numeric","numeric","numeric","numeric"))return p.G.fromCoordinates(t[0],t[1],t[2],t[3])}},p.G={fromCoordinates:function(t,e,i,n){var r=d(t),s=d(e),o=d(i),a=d(n),u=new p(r._.value,s._.value,o._.value,a._.value);return u._addParentParams({x0:r,y0:s,x1:o,y1:a}),u._update=p.U.fromCoordinates,u},fromPointPoint:function(t,e){var i=new p(t._.x,t._.y,e._.x,e._.y);return i._addParentParams({start:t,end:e}),i._update=p.U.fromPointPoint,i}},p.U={fromCoordinates:function(){this._.x0=this._.p.x0._.value,this._.y0=this._.p.y0._.value,this._.x1=this._.p.x1._.value,this._.y1=this._.p.y1._.value},fromPointPoint:function(){this._.x0=this._.p.start._.x,this._.y0=this._.p.start._.y,this._.x1=this._.p.end._.x,this._.y1=this._.p.end._.y}};var l={args:[],objects:function(t){return this.args=t,this},ofTypes:function(){var t=arguments,e=t.length;if(!this.args||this.args.length!=e)return!1;for(var i=this.args.length,n=0;i>n;n++)if("numeric"===t[n]){if(!m.isNumber(this.args[n])&&!this.args[n]._.hasOwnProperty("value"))return!1}else if("boolean"===t[n]){if(!m.isBoolean(this.args[n]))return!1}else if("number"===t[n]){if(!m.isNumber(this.args[n]))return!1}else if("array"===t[n]){if(!m.isArray(this.args[n]))return!1}else if("function"===t[n]){if(!m.isFunction(this.args[n]))return!1}else if("string"===t[n]){if(!m.isString(this.args[n]))return!1}else if(this.args[n]._.type!==t[n])return!1;return!0}},_=function(t){return{arg:t,primitive:function(t){return"number"===t?m.isNumber(this.arg):"array"===t?m.isArray(this.arg):"function"===t?m.isFunction(this.arg):!1}}},d=function(t){return m.isNumber(t)?new o(t):t};if(this.canvasId=t,this.canvas=document.getElementById(t),!this.canvas)return console.error('Sketchpad: Must initialize Sketchpad with a valid id for a DOM canvas object, e.g. var pad = new Sketchpad("padCanvasId")'),null;this.gr=this.canvas.getContext("2d"),this.parentDiv=this.canvas.parentNode,this._canvasWidth=$(this.parentDiv).innerWidth(),this._canvasHeight=$(this.parentDiv).innerHeight(),this.canvas.width=this._canvasWidth,this.canvas.height=this._canvasHeight,$(window).resize(function(){i._canvasWidth=$(i.parentDiv).innerWidth(),i._canvasHeight=$(i.parentDiv).innerHeight(),i.canvas.width=i._canvasWidth,i.canvas.height=i._canvasHeight}),this.initialized=!0,console.info&&console.info("Sketchpad.js "+this.version+" - Build "+this.build),this.loop(),this.mouse={x:0,y:0,down:!1,downX:0,downY:0,dragObject:null,dist2ToNode:function(t,e,i){return(i._.x-t)*(i._.x-t)+(i._.y-e)*(i._.y-e)},searchNodeToDrag:function(t,e){for(var n=i.elements.length-1;n>-1;n--){var r=i.elements[n];if("node"===r._.subtype&&25>this.dist2ToNode(t,e,r))return r}return null},onMouseDown:function(){i.mouse.down=!0,i.mouse.downX=i.mouse.x,i.mouse.downY=i.mouse.y,i.mouse.dragObject=i.mouse.searchNodeToDrag(i.mouse.downX,i.mouse.downY)},onMouseMove:function(t){var e=$(i.canvas).offset();i.mouse.x=t.pageX-e.left,i.mouse.y=t.pageY-e.top,i.mouse.dragObject&&i.mouse.dragObject.set(i.mouse.x,i.mouse.y)},onMouseUp:function(){i.mouse.down=!1,i.mouse.dragObject=null}},$(this.canvas).mousedown(this.mouse.onMouseDown),$(this.canvas).mousemove(this.mouse.onMouseMove),$(this.canvas).mouseup(this.mouse.onMouseUp);var m={isBoolean:function(t){return t===!0||t===!1||"[object Boolean]"===toString.call(t)},isNumber:function(t){return"[object Number]"===toString.call(t)},isNumberArray:function(t){if(!m.isArray(t))return!1;for(var e=t.length,i=0;e>i;i++)if(!m.isNumber(t[i]))return!1;return!0},isFunction:function(t){return"[object Function]"===toString.call(t)},isArray:function(t){return Array.isArray?Array.isArray(t):"[object Array]"===toString.call(t)},isString:function(t){return"[object String]"===toString.call(t)},isSet:function(t){return"set"===t._.type},isPoint:function(t){return"point"===t._.type},isLine:function(t){return"line"===t._.type},isCircle:function(t){return"circle"===t._.type},isValue:function(t){return"value"===t._.type},clampValue:function(t,e,i){return Math.max(e,Math.min(t,i))},map:function(t,e,i,n,r,s){return s&&(e>t?t=e:t>i&&(t=i)),n+(t-e)*(r-n)/(i-e)}};this.utils=m},window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)}}();