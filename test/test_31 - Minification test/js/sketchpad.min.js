/*! sketchpad 2015-02-15 */
Sketchpad=function(t){if(this.version="v0.0.3",this.build=1100,!window.jQuery)return console.error("Sketchpad.js depends on jQuery. Please add it to current window context."),void 0;var e={BOOLEAN:1,NUMBER:2,INTEGER:3,FLOAT:4,STRING:5,SET:11,MEASURE:12,POINT:21,NODE:22,LINE:23,CIRCLE:24,LENGTH:31,AREA:32,VOLUME:33,ANGLE_RAD:34,ANGLE_DEG:35,STYLE:41,LABEL:42,TAG:43,PI:Math.PI,TAU:2*Math.PI,TO_DEGS:180/Math.PI,TO_RADS:Math.PI/180},n=this;this.elements=[],this.initialized=!1,this.canvas,this.canvasId,this.gr,this.parentDiv,this._canvasWidth,this._canvasHeight,this.width,this.height,this.frameCount=0,this.drawVisible=!0,this.start=function(){},this.update=function(){},this.preupdate=function(){},this.render=function(){n.gr.globalAlpha=1,n.gr.fillStyle="#ffffff",n.gr.clearRect(0,0,n._canvasWidth,n._canvasHeight),n.gr.fillRect(0,0,n._canvasWidth,n._canvasHeight),n.gr.translate(.5,.5);for(var t=0;n.elements.length>t;t++)n.elements[t].visible&&(n.elements[t].type==e.SET&&n.elements[t].subtype!=e.NUMBER||n.elements[t].render(n.gr));n.gr.translate(-.5,-.5)},this.loop=function(){window.requestAnimFrame(n.loop),n.preupdate(),n.render(),n.update(),n.frameCount++},this.addElement=function(t){n.elements.push(t)},this.visible=function(){this.drawVisible=!0},this.invisible=function(){this.drawVisible=!1},this.currentStyle=function(t){return this.style=t||new Style({}),this.style},this.toRadians=function(t){return console.warn("pad.toRadians is deprecated, consider using pad.C.TORAD instead"),t*Math.PI/180},this.findElementNames=function(){this.elements.forEach(function(t){t.name||t.findName()})},this.tagElementNames=function(){this.elements.forEach(function(t){t.name||t.findName(),t.name&&this.Tag.on(t,t.name)},this)},this.tagNodes=function(){this.elements.forEach(function(t){t.subtype==e.NODE&&(t.name||t.findName(),t.name&&this.Tag.on(t,t.name))},this)},this.tagPoints=function(){this.elements.forEach(function(t){(t.type==e.POINT||t.subtype==e.NODE)&&(t.name||t.findName(),t.name&&(this.Tag.on(t,t.name),t.setVisible(!0)))},this)},this.showPoints=function(){this.elements.forEach(function(t){t.type==e.POINT&&t.setVisible(!0)})};var s={setRangeFromNumbers:function(t,s,i){for(var r=(s-t)/i,a=[],o=t;s>=o;o+=r)a.push(o);var h=new n.Set(a);return h.subtype=e.NUMBER,h.start=t,h.end=s,h.steps=i,h.visible=!1,h},setSequenceFromNumbers:function(t,s,i){for(var r=[],a=0;i>a;a++)r.push(t+a*s);var o=new n.Set(r);return o.subtype=e.NUMBER,o.start=t,o.stepSize=s,o.count=i,o.visible=!1,o},setRandomSequenceFromNumbers:function(t,s,i){for(var r=[],a=s-t,o=0;i>o;o++)r.push(t+a*Math.random());var h=new n.Set(r);return h.subtype=e.NUMBER,h.start=t,h.end=s,h.count=i,h.visible=!1,h},pointFromTwoMeasures:function(t,e){var s=new n.Point(0,0);return s.addParents(t,e),s.update=function(){this.x=this.parents[0].value,this.y=this.parents[1].value},s.update(),s},pointOffsetNumberNumber:function(t,e,s){var i=new n.Point(0,0);return i.addParents(t,e,s),i.update=function(){this.x=this.parents[0].x+this.parents[1],this.y=this.parents[0].y+this.parents[2]},i.update(),i},pointOffsetNumberMeasure:function(t,e,s){var i=new n.Point(0,0);return i.addParents(t,e,s),i.update=function(){this.x=this.parents[0].x+this.parents[1],this.y=this.parents[0].y+this.parents[2].value},i.update(),i},pointOffsetMeasureNumber:function(t,e,s){var i=new n.Point(0,0);return i.addParents(t,e,s),i.update=function(){this.x=this.parents[0].x+this.parents[1].value,this.y=this.parents[0].y+this.parents[2]},i.update(),i},pointOffsetMeasureMeasure:function(t,e,s){var i=new n.Point(0,0);return i.addParents(t,e,s),i.update=function(){this.x=this.parents[0].x+this.parents[1].value,this.y=this.parents[0].y+this.parents[2].value},i.update(),i},pointOffsetPolarNumberNumber:function(t,e,s){var i=new n.Point(0,0);return i.addParents(t,e,s),i.update=function(){this.x=this.parents[0].x+this.parents[1]*Math.cos(this.parents[2]),this.y=this.parents[0].y+this.parents[1]*Math.sin(this.parents[2])},i.update(),i},pointOffsetPolarNumberMeasure:function(t,e,s){var i=new n.Point(0,0);return i.addParents(t,e,s),i.update=function(){this.x=this.parents[0].x+this.parents[1]*Math.cos(this.parents[2].value),this.y=this.parents[0].y+this.parents[1]*Math.sin(this.parents[2].value)},i.update(),i},pointOffsetPolarMeasureNumber:function(t,e,s){var i=new n.Point(0,0);return i.addParents(t,e,s),i.update=function(){this.x=this.parents[0].x+this.parents[1].value*Math.cos(this.parents[2]),this.y=this.parents[0].y+this.parents[1].value*Math.sin(this.parents[2])},i.update(),i},pointOffsetPolarMeasureMeasure:function(t,e,s){var i=new n.Point(0,0);return i.addParents(t,e,s),i.update=function(){this.x=this.parents[0].x+this.parents[1].value*Math.cos(this.parents[2].value),this.y=this.parents[0].y+this.parents[1].value*Math.sin(this.parents[2].value)},i.update(),i},pointOnLine:function(t,e){var i=new n.Point(0,0);return i.addParents(t,e),i.update=function(){this.x=this.parents[0].x0+this.parents[1]*(this.parents[0].x1-this.parents[0].x0),this.y=this.parents[0].y0+this.parents[1]*(this.parents[0].y1-this.parents[0].y0)},i.setParameter=s.setParameter,i.update(),i},pointOnLineFromMeasure:function(t,e){var s=new n.Point(0,0);return s.addParents(t,e),s.update=function(){this.x=this.parents[0].x0+this.parents[1].value*(this.parents[0].x1-this.parents[0].x0),this.y=this.parents[0].y0+this.parents[1].value*(this.parents[0].y1-this.parents[0].y0)},s.update(),s},pointsOnLineFromNumberSet:function(t,s){for(var i=[],r=s.length,a=0;r>a;a++)i.push(new n.Point(0,0));var o=new n.Set(i);return o.subtype=e.POINT,o.addParents(t,s),o.update=function(){for(var t=0;this.length>t;t++)this.items[t].x=this.parents[0].x0+this.parents[1].items[t]*(this.parents[0].x1-this.parents[0].x0),this.items[t].y=this.parents[0].y0+this.parents[1].items[t]*(this.parents[0].y1-this.parents[0].y0)},o.update(),o},setParameter:function(t){this.parents[1]=t,this.update(),this.updateChildren()},pointOnCircle:function(t,i){var r=new n.Point(0,0);return r.addParents(t,i),r.update=function(){var t=this.parents[1]%1*e.TAU;this.x=this.parents[0].x+this.parents[0].r*Math.cos(t),this.y=this.parents[0].y+this.parents[0].r*Math.sin(t)},r.setParameter=s.setParameter,r.update(),r},pointOnCircleFromMeasure:function(t,s){var i=new n.Point(0,0);return i.addParents(t,s),i.update=function(){var t=this.parents[1].value%1*e.TAU;this.x=this.parents[0].x+this.parents[0].r*Math.cos(t),this.y=this.parents[0].y+this.parents[0].r*Math.sin(t)},i.update(),i},pointsOnCircleFromNumberSet:function(t,s){for(var i=[],r=s.length,a=0;r>a;a++)i.push(new n.Point(0,0));var o=new n.Set(i);return o.subtype=e.POINT,o.addParents(t,s),o.update=function(){for(var t=0;this.length>t;t++){var n=this.parents[1].items[t]%1*e.TAU;this.items[t].x=this.parents[0].x+this.parents[0].r*Math.cos(n),this.items[t].y=this.parents[0].y+this.parents[0].r*Math.sin(n)}},o.update(),o},pointProjectionOnLine:function(t,e){var s=new n.Point(0,0);return s.addParents(t,e),s.update=function(){var t=this.parents[1].x1-this.parents[1].x0,e=this.parents[1].y1-this.parents[1].y0,s=this.parents[0].x-this.parents[1].x0,i=this.parents[0].y-this.parents[1].y0,r=n.U.lineLength(this.parents[1]),a=(t*s+e*i)/r;this.x=this.parents[1].x0+a*t/r,this.y=this.parents[1].y0+a*e/r},s.update(),s},pointProjectionOnCircle:function(t,e){var s=new n.Point(0,0);return s.addParents(t,e),s.update=function(){var t=n.U.angleBetweenCoordinates(this.parents[1].x,this.parents[1].y,this.parents[0].x,this.parents[0].y);this.x=this.parents[1].x+this.parents[1].r*Math.cos(t),this.y=this.parents[1].y+this.parents[1].r*Math.sin(t)},s.update(),s},pointIntersectionlLineLine:function(t,e){var s=new n.Point(0,0);return s.addParents(t,e),s.update=function(){var t=this.parents[0].x0-this.parents[0].x1,e=this.parents[0].y0-this.parents[0].y1,n=this.parents[1].x0-this.parents[1].x1,s=this.parents[1].y0-this.parents[1].y1,i=t*s-e*n;if(0==i)console.log("Lines are parallel, no line-line intersection"),this.x=0,this.y=0;else{var r=this.parents[0].x0*this.parents[0].y1-this.parents[0].y0*this.parents[0].x1,a=this.parents[1].x0*this.parents[1].y1-this.parents[1].y0*this.parents[1].x1;this.x=(r*n-t*a)/i,this.y=(r*s-e*a)/i}},s.update(),s},pointIntersectionlLineCircle:function(t,s){var i=new n.Set([new n.Point(0,0),new n.Point(0,0)]);return i.subtype=e.POINT,i.addParents(t,s),i.update=function(){var t=this.parents[0].x1-this.parents[0].x0,e=this.parents[0].y1-this.parents[0].y0,n=this.parents[0].x0-this.parents[1].x,s=this.parents[0].y0-this.parents[1].y,i=this.parents[1].r,r=t*t+e*e,a=2*(t*n+e*s),o=n*n+s*s-i*i,h=a*a-4*r*o;if(0>h)this.items[0].x=this.items[0].y=this.items[1].x=this.items[1].y=0;else{var u=Math.sqrt(h),p=(-a-u)/(2*r),d=(-a+u)/(2*r);this.items[0].x=this.parents[0].x0+p*t,this.items[0].y=this.parents[0].y0+p*e,this.items[1].x=this.parents[0].x0+d*t,this.items[1].y=this.parents[0].y0+d*e}},i.update(),i},pointIntersectionlCircleCircle:function(t,s){var i=new n.Set([new n.Point(0,0),new n.Point(0,0)]);return i.subtype=e.POINT,i.addParents(t,s),i.update=function(){var t=this.parents[0].x,e=this.parents[0].y,s=this.parents[0].r,i=this.parents[1].x,r=this.parents[1].y,a=this.parents[1].r,o=n.U.distanceBetweenCoordinates(t,e,i,r);if(o>s+a||Math.abs(s-a)>o)this.items[0].x=this.items[0].y=this.items[1].x=this.items[1].y=0;else{var h=Math.sqrt((o+s+a)*(o+s-a)*(o-s+a)*(-o+s+a))/4,u=(t+i)/2+(i-t)*(s*s-a*a)/(2*o*o),p=2*(t-i)*h/(o*o),d=(e+r)/2+(r-e)*(s*s-a*a)/(2*o*o),l=2*(e-r)*h/(o*o);this.items[0].x=u+l,this.items[0].y=d-p,this.items[1].x=u-l,this.items[1].y=d+p}},i.update(),i},circleFromPointAndRadius:function(t,e){var s=new n.Circle(0,0,e);return s.addParents(t),s.update=function(){this.x=this.parents[0].x,this.y=this.parents[0].y},s.update(),s},circleFromPointAndMeasure:function(t,e){var s=new n.Circle(0,0,0);return s.addParents(t,e),s.update=function(){this.x=this.parents[0].x,this.y=this.parents[0].y,this.r=this.parents[1].value},s.update(),s}};this.U={lineLength:function(t){var e=t.x1-t.x0,n=t.y1-t.y0;return Math.sqrt(e*e+n*n)},distanceBetweenCoordinates:function(t,e,n,s){return Math.sqrt((n-t)*(n-t)+(s-e)*(s-e))},distanceBetweenPoints:function(t,e){var n=e.x-t.x,s=e.y-t.y;return Math.sqrt(n*n+s*s)},angleBetweenCoordinates:function(t,e,n,s){return Math.atan2(s-e,n-t)},angleBetween2Points:function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)},angleBetween3Points:function(t,e,n){return Math.atan2(n.y-t.y,n.x-t.x)-Math.atan2(e.y-t.y,e.x-t.x)}},this.Element=function(){this.parents=[],this.children=[],this.visible=void 0,this.name=void 0,this.style=n.style,this.parts={}},this.Element.prototype.addParents=function(){for(var t=arguments.length,e=0;t>e;e++)r.isArray(arguments[e])?0==arguments[e].length||arguments[e].forEach(function(t){this.addParents(t)},this):(this.parents.push(arguments[e]),arguments[e].children&&arguments[e].children.push(this))},this.Element.prototype.addChild=function(t){console.warn("Element.addChild is deprecated, consider using Element.isChildOf instead"),this.children.push(t)},this.Element.prototype.isChildOf=function(){for(var t=arguments.length,e=0;t>e;e++)arguments[e].children.push(this)},this.Element.prototype.updateChildren=function(){for(var t=0;this.children.length>t;t++)this.children[t].update(),this.children[t].updateChildren()},this.Element.prototype.setVisible=function(t){this.visible=t},this.Element.prototype.checkStates=function(){void 0==this.visible&&(this.visible=n.drawVisible)},this.Element.prototype.setStyle=function(t){this.style=t},this.Element.prototype.findName=function(){for(var t in window)if(window[t]==this)return this.name=t,t;return!1},this.Geometry=function(){},this.Geometry.prototype=Object.create(this.Element.prototype),this.Geometry.prototype.constructor=this.Geometry,this.Point=function(t,s){n.Element.call(this),n.addElement(this),this.pad=n,this.type=e.POINT,this.x=t,this.y=s,this.r=1,this.visible=!1,this.checkStates()},this.Point.prototype=Object.create(this.Element.prototype),this.Point.prototype.constructor=this.Point,this.Point.prototype.render=function(){n.gr.strokeStyle=this.style.stroke,n.gr.lineWidth=this.style.strokeWidth,n.gr.fillStyle=this.style.fill,n.gr.beginPath(),n.gr.arc(this.x,this.y,this.r,0,2*Math.PI),n.gr.stroke(),n.gr.fill()},this.Point.prototype.setPosition=function(t,e){this.x=t,this.y=e,this.updateChildren()},this.Point.prototype.move=function(t,e){this.x+=t,this.y+=e,this.updateChildren()},this.Point.fromMeasures=function(t,n){return t.type==e.MEASURE&&n.type==e.MEASURE?s.pointFromTwoMeasures(t,n):(console.error("Sketchpad: invalid arguments for Point.fromMeasures"),void 0)},this.Point.along=function(t,n){return t.type==e.LINE&&"number"==typeof n?s.pointOnLine(t,n):t.type==e.CIRCLE&&"number"==typeof n?s.pointOnCircle(t,n):t.type==e.LINE&&n.type==e.MEASURE?s.pointOnLineFromMeasure(t,n):t.type==e.CIRCLE&&n.type==e.MEASURE?s.pointOnCircleFromMeasure(t,n):t.type==e.LINE&&n.type==e.SET&&n.subtype==e.NUMBER?s.pointsOnLineFromNumberSet(t,n):t.type==e.CIRCLE&&n.type==e.SET&&n.subtype==e.NUMBER?s.pointsOnCircleFromNumberSet(t,n):(console.error("Sketchpad: invalid arguments for Point.along"),void 0)},this.Point.projection=function(t,n){return t.type==e.POINT&&n.type==e.LINE?s.pointProjectionOnLine(t,n):t.type==e.POINT&&n.type==e.CIRCLE?s.pointProjectionOnCircle(t,n):(console.error("Sketchpad: invalid arguments for Point.projection"),void 0)},this.Point.intersection=function(t,n){return t.type==e.LINE&&n.type==e.LINE?s.pointIntersectionlLineLine(t,n):t.type==e.LINE&&n.type==e.CIRCLE?s.pointIntersectionlLineCircle(t,n):t.type==e.CIRCLE&&n.type==e.LINE?s.pointIntersectionlLineCircle(n,t):t.type==e.CIRCLE&&n.type==e.CIRCLE?s.pointIntersectionlCircleCircle(t,n):(console.error("Sketchpad: invalid arguments for Point.intersection"),void 0)},this.Point.offset=function(t,n,i){return t.type==e.POINT&&r.isNumber(n)&&r.isNumber(i)?s.pointOffsetNumberNumber(t,n,i):t.type==e.POINT&&n.type==e.MEASURE&&r.isNumber(i)?s.pointOffsetMeasureNumber(t,n,i):t.type==e.POINT&&r.isNumber(n)&&i.type==e.MEASURE?s.pointOffsetNumberMeasure(t,n,i):t.type==e.POINT&&n.type==e.MEASURE&&i.type==e.MEASURE?s.pointOffsetMeasureMeasure(t,n,i):(console.error("Sketchpad: invalid arguments for Point.offset"),void 0)},this.Point.offsetPolar=function(t,n,i){return t.type==e.POINT&&r.isNumber(n)&&r.isNumber(i)?s.pointOffsetPolarNumberNumber(t,n,i):t.type==e.POINT&&n.type==e.MEASURE&&r.isNumber(i)?s.pointOffsetPolarMeasureNumber(t,n,i):t.type==e.POINT&&r.isNumber(n)&&i.type==e.MEASURE?s.pointOffsetPolarNumberMeasure(t,n,i):t.type==e.POINT&&n.type==e.MEASURE&&i.type==e.MEASURE?s.pointOffsetPolarMeasureMeasure(t,n,i):(console.error("Sketchpad: invalid arguments for Point.offset"),void 0)},this.N={nodeOnLine:function(t,e,s){var i=new n.Node(0,0),a=s?s.clamp||!1:!1,o=e||.5;return a&&(o=r.clampValue(o,0,1)),i.addParents(t,o,a),i.update=function(){this.x=this.parents[0].x0+this.parents[1]*(this.parents[0].x1-this.parents[0].x0),this.y=this.parents[0].y0+this.parents[1]*(this.parents[0].y1-this.parents[0].y0)},i.setPosition=function(t,e){var s=this.parents[0].x1-this.parents[0].x0,i=this.parents[0].y1-this.parents[0].y0,a=t-this.parents[0].x0,o=e-this.parents[0].y0,h=n.U.lineLength(this.parents[0]);this.parents[1]=(s*a+i*o)/(h*h),this.parents[2]&&(this.parents[1]=r.clampValue(this.parents[1],0,1)),this.update()},i.update(),i},nodeOnCircle:function(t,s){var i=new n.Node(0,0),r=s||0;return i.addParents(t,r),i.update=function(){var t=this.parents[1]%1*e.TAU;this.x=this.parents[0].x+this.parents[0].r*Math.cos(t),this.y=this.parents[0].y+this.parents[0].r*Math.sin(t)},i.setPosition=function(t,s){var i=n.U.angleBetweenCoordinates(this.parents[0].x,this.parents[0].y,t,s);this.parents[1]=i/e.TAU,this.update()},i.update(),i},nodeHorizontalMovementFromNumber:function(t,e){var s=new n.Node(0,0);return s.addParents(t,e),s.update=function(){this.x=this.parents[0],this.y=this.parents[1]},s.setPosition=function(t){this.parents[0]=t,this.update()},s.update(),s},nodeHorizontalMovementFromMeasure:function(t,e){var s=new n.Node(0,0);return s.addParents(t,e),s.update=function(){this.x=this.parents[0],this.y=this.parents[1].value},s.setPosition=function(t){this.parents[0]=t,this.update()},s.update(),s},nodeVerticalMovementFromNumber:function(t,e){var s=new n.Node(0,0);return s.addParents(t,e),s.update=function(){this.x=this.parents[0],this.y=this.parents[1]},s.setPosition=function(t,e){this.parents[1]=e,this.update()},s.update(),s},nodeVerticalMovementFromMeasure:function(t,e){var s=new n.Node(0,0);return s.addParents(t,e),s.update=function(){this.x=this.parents[0].value,this.y=this.parents[1]},s.setPosition=function(t,e){this.parents[1]=e,this.update()},s.update(),s}},this.Node=function(t,s){n.Point.call(this,t,s),this.subtype=e.NODE,this.visible=!0,this.r=4},this.Node.prototype=Object.create(this.Point.prototype),this.Node.prototype.constructor=this.Node,this.Node.along=function(t,s,i){return s.type==e.MEASURE&&(console.warn("Sketchpad: setting a Measure for Node.along would allow no degrees of freedom in this Node, using Measure.value instead"),s=s.value),t.type==e.LINE&&r.isNumber(s)?n.N.nodeOnLine(t,s,i):t.type==e.CIRCLE&&r.isNumber(s)?n.N.nodeOnCircle(t,s,i):(console.error("Sketchpad: invalid arguments for Node.along"),void 0)},this.Node.horizontal=function(t,s){return t.type==e.MEASURE&&(console.warn("Sketchpad: setting a Measure for startX in Node.horizontal would allow no degrees of freedom in this Node, using Measure.value instead"),t=t.value),r.isNumber(t)&&r.isNumber(s)?n.N.nodeHorizontalMovementFromNumber(t,s):r.isNumber(t)&&s.type==e.MEASURE?n.N.nodeHorizontalMovementFromMeasure(t,s):(console.error("Sketchpad: invalid arguments for Node.horizontal"),void 0)},this.Node.vertical=function(t,s){return s.type==e.MEASURE&&(console.warn("Sketchpad: setting a Measure for startY in Node.horizontal would allow no degrees of freedom in this Node, using Measure.value instead"),s=s.value),r.isNumber(t)&&r.isNumber(s)?n.N.nodeVerticalMovementFromNumber(t,s):t.type==e.MEASURE&&r.isNumber(s)?n.N.nodeVerticalMovementFromMeasure(t,s):(console.error("Sketchpad: invalid arguments for Node.horizontal"),void 0)};var i=function(t,s,i,r){n.Element.call(this),n.addElement(this),this.type=e.LINE,this.x0=t,this.y0=s,this.x1=i,this.y1=r,this.checkStates()};i.prototype=Object.create(this.Geometry.prototype),i.prototype.constructor=this.Line,i.prototype.render=function(){n.gr.strokeStyle=this.style.stroke,n.gr.lineWidth=this.style.strokeWidth,n.gr.beginPath(),n.gr.moveTo(this.x0,this.y0),n.gr.lineTo(this.x1,this.y1),n.gr.stroke()},i.prototype.start=function(){return 0!=arguments.length?(console.error("Sketchpad: invalid arguments for Line.start"),void 0):(this.parts.start||(this.parts.start=n.Point.along(this,0)),this.parts.start)},i.prototype.end=function(){return 0!=arguments.length?(console.error("Sketchpad: invalid arguments for Line.end"),void 0):(this.parts.end||(this.parts.end=n.Point.along(this,1)),this.parts.end)},i.prototype.center=function(){return 0!=arguments.length?(console.error("Sketchpad: invalid arguments for Line.center"),void 0):(this.parts.center||(this.parts.center=new n.Point.along(this,.5)),this.parts.center)},i.prototype.length=function(){if(0!=arguments.length)return console.error("Sketchpad: invalid arguments for Line.length"),void 0;if(!this.parts.length){var t=this.start(),e=this.end();this.parts.length=n.Measure.distance(t,e)}return this.parts.length},i.prototype.angle=function(){if(0!=arguments.length)return console.error("Sketchpad: invalid arguments for Line.angle"),void 0;if(!this.parts.angle){var t=this.start(),e=this.end();this.parts.angle=n.Measure.angle(t,e)}return this.parts.angle},i.G={fromTwoPoints:function(t,e){var n=new i(0,0,0,0);return n.addParents(t,e),n.update=function(){this.x0=this.parents[0].x,this.y0=this.parents[0].y,this.x1=this.parents[1].x,this.y1=this.parents[1].y},n.update(),n},fromPointToPointset:function(t,s){for(var r=[],a=s.length,o=0;a>o;o++)r.push(new i(0,0,0,0));var h=new n.Set(r);return h.subtype=e.LINE,h.addParents(t,s),h.update=function(){for(var t=0;this.length>t;t++)this.items[t].x0=this.parents[0].x,this.items[t].y0=this.parents[0].y,this.items[t].x1=this.parents[1].items[t].x,this.items[t].y1=this.parents[1].items[t].y},h.update(),h},fromPointsetToPointset:function(t,s){for(var r=[],a=t.length>s.length?t.length:s.length,o=0;a>o;o++)r.push(new i(0,0,0,0));var h=new n.Set(r);return h.subtype=e.LINE,h.addParents(t,s),h.update=function(){for(var t=this.parents[0].length,e=this.parents[1].length,n=0,s=0,i=0;this.length>i;i++)this.items[i].x0=this.parents[0].items[n].x,this.items[i].y0=this.parents[0].items[n++].y,this.items[i].x1=this.parents[1].items[s].x,this.items[i].y1=this.parents[1].items[s++].y,n>=t&&n--,s>=e&&s--},h.update(),h},fromPointLengthAngle:function(t,e,n){var s=new i(0,0,0,0);return s.addParents(t),s.length=e,s.angle=n,s.update=function(){this.x0=this.parents[0].x,this.y0=this.parents[0].y,this.x1=this.x0+this.length*Math.cos(this.angle),this.y1=this.y0+this.length*Math.sin(this.angle)},s.update(),s},fromPointMeasureAngle:function(t,e,n){var s=new i(0,0,0,0);return s.addParents(t,e),s.angle=n,s.update=function(){this.x0=this.parents[0].x,this.y0=this.parents[0].y,this.x1=this.x0+this.parents[1].value*Math.cos(this.angle),this.y1=this.y0+this.parents[1].value*Math.sin(this.angle)},s.update(),s},fromPointLengthMeasure:function(t,n,s){var r=new i(0,0,0,0);return r.addParents(t,s),r.length=n,r.update=function(){var t=this.parents[1].subtype==e.ANGLE_DEG?this.parents[1].value*e.TO_RADS:this.parents[1].value;this.x0=this.parents[0].x,this.y0=this.parents[0].y,this.x1=this.x0+this.length*Math.cos(t),this.y1=this.y0+this.length*Math.sin(t)},r.update(),r},fromPointMeasureMeasure:function(t,n,s){var r=new i(0,0,0,0);return r.addParents(t,n,s),r.update=function(){var t=this.parents[2].subtype==e.ANGLE_DEG?this.parents[2].value*e.TO_RADS:this.parents[2].value;this.x0=this.parents[0].x,this.y0=this.parents[0].y,this.x1=this.x0+this.parents[1].value*Math.cos(t),this.y1=this.y0+this.parents[1].value*Math.sin(t)},r.update(),r}},this.line=function(){var t=arguments,e=t.length;switch(e){case 2:if(r.isPoint(t[0])&&r.isPoint(t[1]))return n.line.between(t[0],t[1]);break;case 3:if(r.isNumber(t[0])&&r.isNumber(t[1])&&r.isPoint(t[2]))return n.line.between(new n.Point(t[0],t[1]),t[2]);if(r.isPoint(t[0])&&r.isNumber(t[1])&&r.isNumber(t[2]))return n.line.between(t[0],new n.Point(t[1],t[2]));break;case 4:if(r.isNumberArray(t))return new i(t[0],t[1],t[2],t[3])}return console.error("Sketchpad: invalid arguments for Sketchpad.line"),void 0},this.line.between=function(t,n){return r.isPoint(t)&&r.isPoint(n)?i.G.fromTwoPoints(t,n):r.isPoint(t)&&r.isSet(n)&&n.subtype==e.POINT?i.G.fromPointToPointset(t,n):r.isSet(t)&&t.subtype==e.POINT&&r.isSet(n)&&n.subtype==e.POINT?i.G.fromPointsetToPointset(t,n):(console.error("Sketchpad: invalid arguments for Line.between"),void 0)},this.line.polar=function(t,e,n){return r.isPoint(t)&&r.isNumber(e)&&r.isNumber(n)?i.G.fromPointLengthAngle(t,e,n):r.isPoint(t)&&r.isMeasure(e)&&r.isNumber(n)?i.G.fromPointMeasureAngle(t,e,n):r.isPoint(t)&&r.isNumber(e)&&r.isMeasure(n)?i.G.fromPointLengthMeasure(t,e,n):r.isPoint(t)&&r.isMeasure(e)&&r.isMeasure(n)?i.G.fromPointMeasureMeasure(t,e,n):(console.error("Sketchpad: invalid arguments for Line.polar"),void 0)},this.Circle=function(t,s,i){n.Element.call(this),n.addElement(this),this.type=e.CIRCLE,this.x=t,this.y=s,this.r=i,this.checkStates()},this.Circle.prototype=Object.create(this.Element.prototype),this.Circle.prototype.constructor=this.Circle,this.Circle.prototype.render=function(){n.gr.strokeStyle=this.style.stroke,n.gr.lineWidth=this.style.strokeWidth,n.gr.fillStyle=this.style.fill,n.gr.beginPath(),n.gr.arc(this.x,this.y,this.r,0,2*Math.PI),n.gr.fill(),n.gr.stroke()},this.Circle.prototype.setRadius=function(t){this.r=t,this.updateChildren()},this.Circle.centerRadius=function(t,n){return t.type==e.POINT&&"number"==typeof n?s.circleFromPointAndRadius(t,n):t.type==e.POINT&&n.type==e.MEASURE?s.circleFromPointAndMeasure(t,n):(console.error("Sketchpad: invalid arguments for Line.centerRadius"),void 0)},this.M={canvasWidth:function(){var t=new n.Measure(0);return t.update=function(){this.value=$(n.parentDiv).innerWidth()},t.update(),t},canvasHeight:function(){var t=new n.Measure(0);return t.update=function(){this.value=$(n.parentDiv).innerHeight()},t.update(),t},distanceBetweenTwoPoints:function(t,s){var i=new n.Measure(0);return i.addParents(t,s),i.subtype=e.LENGTH,i.update=function(){var t=this.parents[1].x-this.parents[0].x,e=this.parents[1].y-this.parents[0].y;this.value=Math.sqrt(t*t+e*e)},i.update(),i},angleBetweenTwoPoints:function(t,s){var i=new n.Measure(0);return i.addParents(t,s),i.subtype=e.ANGLE_RAD,i.update=function(){this.value=n.U.angleBetween2Points(this.parents[0],this.parents[1])},i.update(),i},angleBetweenThreePoints:function(t,s,i){var r=new n.Measure(0);return r.addParents(t,s,i),r.subtype=e.ANGLE_RAD,r.update=function(){this.value=n.U.angleBetween3Points(this.parents[0],this.parents[1],this.parents[2])},r.update(),r},transformMeasure:function(t,s){var i=new n.Measure(0);return i.addParents(t),i.subtype=e.LENGTH,i.transFunc=s,i.update=function(){this.value=this.transFunc(this.parents)},i.update(),i}},this.Measure=function(t){n.Element.call(this),n.addElement(this),this.type=e.MEASURE,this.value=t,this.visible=!1},this.Measure.prototype=Object.create(this.Element.prototype),this.Measure.prototype.constructor=this.Measure,this.Measure.distance=function(t,s){return t.type==e.POINT&&s.type==e.POINT?n.M.distanceBetweenTwoPoints(t,s):(console.error("Sketchpad: invalid arguments for Measure.distance"),void 0)},this.Measure.angle=function(){var t=arguments,s=t.length;if(2==s){if(t[0].type==e.POINT&&t[1].type==e.POINT)return n.M.angleBetweenTwoPoints(t[0],t[1])}else if(3==s&&t[0].type==e.POINT&&t[1].type==e.POINT&&t[2].type==e.POINT)return n.M.angleBetweenThreePoints(t[0],t[1],t[2]);return console.error("Sketchpad: invalid arguments for Measure.angle"),void 0},this.Measure.compose=function(){var t=arguments,e=t.length;if(2>e)return console.error("Sketchpad: invalid amount of arguments for Measure.compose, must contain at least one Measure and one transform function"),void 0;if(!r.isFunction(t[e-1]))return console.error("Sketchpad: last argument at Measure.compose must be a function"),void 0;for(var s=[],i=0;e-1>i;i++)s.push(t[i]);var a=t[e-1];return n.M.transformMeasure(s,a)},this.Set=function(t){n.Element.call(this),n.addElement(this),this.type=e.SET,this.setItems(t,void 0)},this.Set.prototype=Object.create(this.Element.prototype),this.Set.prototype.constructor=this.Set,this.Set.prototype.setItems=function(t,e){this.items=t,this.length=t.length,this.subtype=e;for(var n=this.items.length,s=0;n>s;s++)this.items[s].parents&&(this.items[s].parents[0]=this)},this.Set.prototype.updateChildren=function(){for(var t=0;this.items.length>t;t++)this.items[t].updateChildren();for(var t=0;this.children.length>t;t++)this.children[t].update(),this.children[t].updateChildren()},this.Set.range=function(t,e,n){return"number"==typeof t&&"number"==typeof e&&"number"==typeof n?s.setRangeFromNumbers(t,e,n):(console.error("Sketchpad: invalid arguments for Set.sequence"),void 0)},this.Set.sequence=function(t,e,n){return"number"==typeof t&&"number"==typeof e&&"number"==typeof n?s.setSequenceFromNumbers(t,e,n):(console.error("Sketchpad: invalid arguments for Set.sequence"),void 0)},this.Set.random=function(t,e,n){return"number"==typeof t&&"number"==typeof e&&"number"==typeof n?s.setRandomSequenceFromNumbers(t,e,n):(console.error("Sketchpad: invalid arguments for Set.random"),void 0)},this.Style=function(t){this.stroke=t.stroke||"#000000",this.strokeWidth=t.strokeWidth||1,this.fill=t.fill?"none"==t.fill?"rgba(0, 0, 0, 0)":t.fill:"rgba(0, 0, 0, 0)",this.fontFamily=t.fontFamily||"Times New Roman",this.fontSize=t.fontSize||"9pt",this.fontStyle=t.fontStyle||"italic",this.fontCSS=t.fontCSS||this.fontStyle+" "+this.fontSize+" "+this.fontFamily,this.textFill=t.textFill||this.stroke,this.textVAlign=t.textVAlign||"bottom",this.textHAlign=t.textHAlign||"center",this.textOffsetX=t.textOffsetX||0,this.textOffsetY=t.textOffsetY||-5},this.Style.prototype.applyTo=function(){for(var t=arguments.length,e=0;t>e;e++)arguments[e].setStyle(this)},this.T={tagOnPointFromString:function(t,e){var s=e||t.name||t.findName(),i=new n.Tag(s,0,0);return i.addParents(t,s),i.update=function(){this.x=this.parents[0].x,this.y=this.parents[0].y},i.update(),i},tagOnLineFromString:function(t,e){var i=e||t.name||t.findName(),r=s.pointOnLine(t,.5);return n.T.tagOnPointFromString(r,i)},tagOnCircleFromString:function(t,e){var s=e||t.name||t.findName(),i=new n.Tag(s,0,0);return i.addParents(t,s),i.update=function(){this.x=this.parents[0].x,this.y=this.parents[0].y},i.update(),i},tagOnPointFromLabel:function(t,e){var s=new n.Tag("",0,0);return s.addParents(t,e),s.update=function(){this.x=this.parents[0].x,this.y=this.parents[0].y,this.text=this.parents[1].text},s.update(),s},tagOnLineFromLabel:function(t,e){new n.Tag("",0,0);var i=s.pointOnLine(t,.5);return n.T.tagOnPointFromLabel(i,e)},tagOnCircleFromLabel:function(t,e){var s=new n.Tag("",0,0);return s.addParents(t,e),s.update=function(){this.x=this.parents[0].x,this.y=this.parents[0].y,this.text=this.parents[1].text},s.update(),s}},this.Tag=function(t,s,i){n.Element.call(this),n.addElement(this),this.type=e.TEXT,this.x=s,this.y=i,this.text=t,this.checkStates()},this.Tag.prototype=Object.create(this.Element.prototype),this.Tag.prototype.constructor=this.Tag,this.Tag.prototype.render=function(){n.gr.fillStyle=this.style.textFill,n.gr.textAlign=this.style.textHAlign,n.gr.textBaseline=this.style.textVAlign,n.gr.font=this.style.fontCSS,n.gr.fillText(this.text,this.x+this.style.textOffsetX,this.y+this.style.textOffsetY)},this.Tag.on=function(t,s){return t.type!=e.POINT&&t.type!=e.NODE||!r.isString(s)?t.type==e.LINE&&r.isString(s)?n.T.tagOnLineFromString(t,s):t.type==e.CIRCLE&&r.isString(s)?n.T.tagOnCircleFromString(t,s):t.type!=e.TAG&&t.type!=e.MEASURE||!r.isString(s)?t.type!=e.POINT&&t.type!=e.NODE||s.type!=e.LABEL?t.type==e.LINE&&s.type==e.LABEL?n.T.tagOnLineFromLabel(t,s):t.type==e.CIRCLE&&s.type==e.LABEL?n.T.tagOnCircleFromLabel(t,s):t.type!=e.TAG&&t.type!=e.MEASURE||s.type!=e.LABEL?(console.error("Sketchpad: invalid arguments for Tag.on"),void 0):void 0:n.T.tagOnPointFromLabel(t,s):void 0:n.T.tagOnPointFromString(t,s)},this.Label=function(t){n.Element.call(this),n.addElement(this),this.type=e.LABEL,this.text=t},this.Label.prototype=Object.create(this.Element.prototype),this.Label.prototype.constructor=this.Label,this.Label.compose=function(){var t=arguments,e=t.length;if(2>e)return console.error("Sketchpad: invalid amount of arguments for Label.compose, must contain at least one Object and one transform function"),void 0;if(!r.isFunction(t[e-1]))return console.error("Sketchpad: last argument at Label.compose must be a function"),void 0;for(var s=[],i=0;e-1>i;i++)s.push(t[i]);var a=t[e-1];return n.L.composeLabel(s,a)},this.Label.from=function(t,s){return t.type==e.MEASURE?s&&s.round?n.Label.compose(t,function(){return Math.round(t.value)}):n.Label.compose(t,function(){return t.value}):(console.error("Sketchpad: invalid arguments for Label.from"),void 0)},this.L={composeLabel:function(t,e){var s=new n.Label("");return s.addParents(t,e),s.update=function(){this.text=this.parents[this.parents.length-1](this.parents)},s.update(),s}};var r={isNumber:function(t){return"[object Number]"===toString.call(t)},isNumberArray:function(t){for(var e=t.length,n=0;e>n;n++)if(!r.isNumber(t[n]))return!1;return!0},isFunction:function(t){return"[object Function]"===toString.call(t)},isArray:function(t){return Array.isArray?Array.isArray(t):"[object Array]"===toString.call(t)},isString:function(t){return"[object String]"===toString.call(t)},isSet:function(t){return t.type==e.SET},isPoint:function(t){return t.type==e.POINT
},isLine:function(t){return t.type==e.LINE},isCircle:function(t){return t.type==e.CIRCLE},isMeasure:function(t){return t.type==e.MEASURE},clampValue:function(t,e,n){return Math.max(e,Math.min(t,n))}};return this.utils=r,this.canvasId=t,this.canvas=document.getElementById(t),this.canvas?(this.style=new this.Style({}),this.gr=this.canvas.getContext("2d"),this.parentDiv=this.canvas.parentNode,this._canvasWidth=$(this.parentDiv).innerWidth(),this._canvasHeight=$(this.parentDiv).innerHeight(),this.canvas.width=this._canvasWidth,this.canvas.height=this._canvasHeight,this.width=this.M.canvasWidth(),this.height=this.M.canvasHeight(),$(window).resize(function(){n._canvasWidth=$(n.parentDiv).innerWidth(),n._canvasHeight=$(n.parentDiv).innerHeight(),n.canvas.width=n._canvasWidth,n.canvas.height=n._canvasHeight,n.width.update(),n.width.updateChildren(),n.height.update(),n.height.updateChildren()}),this.initialized=!0,console.info&&console.info("Sketchpad.js "+this.version+" - Build "+this.build),this.start(),this.loop(),this.mouse={x:0,y:0,down:!1,downX:0,downY:0,dragObject:null,dist2ToNode:function(t,e,n){return(n.x-t)*(n.x-t)+(n.y-e)*(n.y-e)},searchNodeToDrag:function(t,e){for(var s=n.elements.length-1;s>-1;s--){var i=n.elements[s];if(i.constructor==n.Node&&25>this.dist2ToNode(t,e,i))return i}return null},onMouseDown:function(){n.mouse.down=!0,n.mouse.downX=n.mouse.x,n.mouse.downY=n.mouse.y,n.mouse.dragObject=n.mouse.searchNodeToDrag(n.mouse.downX,n.mouse.downY)},onMouseMove:function(t){var e=$(n.canvas).offset();n.mouse.x=t.pageX-e.left,n.mouse.y=t.pageY-e.top,n.mouse.dragObject&&(n.mouse.dragObject.setPosition(n.mouse.x,n.mouse.y),n.mouse.dragObject.updateChildren())},onMouseUp:function(){n.mouse.down=!1,n.mouse.dragObject=null}},$(this.canvas).mousedown(this.mouse.onMouseDown),$(this.canvas).mousemove(this.mouse.onMouseMove),$(this.canvas).mouseup(this.mouse.onMouseUp),void 0):(console.error('Sketchpad: Must initialize Sketchpad with a valid id for a DOM canvas object, e.g. var pad = new Sketchpad("padCanvasId")'),null)},window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)}}();